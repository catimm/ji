$(document).ready(function(){

	// code to show correct view if user is in first step of providing input
	function first_view() {
		if ($("#firstSideArea").hasClass("show")){
			$("#firstSideArea").removeClass("show").addClass("hidden");
		}
		$("#pstep1").removeClass("hidden").addClass("show");
		if ($("#pstep2").hasClass("show")){
			$("#pstep2").removeClass("show").addClass("hidden");
		}
		if ($("#pstep3").hasClass("show")){
			$("#pstep3").removeClass("show").addClass("hidden");
		}
		if ($("#pfinished").hasClass("show")){
			$("#pfinished").removeClass("show").addClass("hidden");
		}
		if ($(".initialBackgroundHeader").hasClass("show")){
			$(".initialBackgroundHeader").removeClass("show").addClass("hidden");
		}
		if ($(".responseBackgroundHeader").hasClass("hidden")){
			$(".responseBackgroundHeader").removeClass("hidden").addClass("show");
		}
		$.ajax({  
			type: "GET",    
	    	url: "/exploring/"+gon.exploration_id+"/problems/"+gon.problem_id
	  	});
	}
	
	// code to show correct view if user is in second step of providing input
	function second_view() {
		if ($("#firstSideArea").hasClass("show")){
			$("#firstSideArea").removeClass("show").addClass("hidden");
		}
		$("#pstep2").removeClass("hidden").addClass("show");
		if ($("#pstep1").hasClass("show")){
			$("#pstep1").removeClass("show").addClass("hidden");
		}
		if ($("#pstep3").hasClass("show")){
			$("#pstep3").removeClass("show").addClass("hidden");
		}
		if ($("#pfinished").hasClass("show")){
			$("#pfinished").removeClass("show").addClass("hidden");
		}
		if ($(".initialBackgroundHeader").hasClass("show")){
			$(".initialBackgroundHeader").removeClass("show").addClass("hidden");
		}
		if ($(".responseBackgroundHeader").hasClass("hidden")){
			$(".responseBackgroundHeader").removeClass("hidden").addClass("show");
		}
		$.ajax({  
			type: "GET",    
	    	url: "/exploring/"+gon.exploration_id+"/problems/"+gon.problem_id
	  	});
	}
	
	// code to show correct view if user is in third step of providing input
	function third_view() {
		if ($("#firstSideArea").hasClass("show")){
			$("#firstSideArea").removeClass("show").addClass("hidden");
		}
		$("#pstep3").removeClass("hidden").addClass("show");
		if ($("#pstep1").hasClass("show")){
			$("#pstep1").removeClass("show").addClass("hidden");
		}
		if ($("#pstep2").hasClass("show")){
			$("#pstep2").removeClass("show").addClass("hidden");
		}
		if ($("#pfinished").hasClass("show")){
			$("#pfinished").removeClass("show").addClass("hidden");
		}
		if ($(".initialBackgroundHeader").hasClass("show")){
			$(".initialBackgroundHeader").removeClass("show").addClass("hidden");
		}
		if ($(".responseBackgroundHeader").hasClass("hidden")){
			$(".responseBackgroundHeader").removeClass("hidden").addClass("show");
		}
		$.ajax({  
			type: "GET",    
	    	url: "/exploring/"+gon.exploration_id+"/problems/"+gon.problem_id
	  	});
	}
	
	// code to show correct view if user is in finished providing input
	function invite_view() {
		if ($("#firstSideArea").hasClass("show")){
			$("#firstSideArea").removeClass("show").addClass("hidden");
		}
		$("#pfinished").removeClass("hidden").addClass("show");
		if ($("#pstep1").hasClass("show")){
			$("#pstep1").removeClass("show").addClass("hidden");
		}
		if ($("#pstep2").hasClass("show")){
			$("#pstep2").removeClass("show").addClass("hidden");
		}
		if ($("#pstep3").hasClass("show")){
			$("#pstep3").removeClass("show").addClass("hidden");
		}
		if ($(".initialBackgroundHeader").hasClass("show")){
			$(".initialBackgroundHeader").removeClass("show").addClass("hidden");
		}
		if ($(".responseBackgroundHeader").hasClass("hidden")){
			$(".responseBackgroundHeader").removeClass("hidden").addClass("show");
		}
		$.ajax({  
			type: "GET",    
	    	url: "/exploring/"+gon.exploration_id+"/problems/"+gon.problem_id
	  	});
	}
	
	// code to determine which view to show when user first opens project page
	if (gon.step == "first") {
		first_view();
	} else if (gon.step == "second") {
		second_view();
	} else if (gon.step == "third") {
		third_view();
	} else if (gon.step == "finished"){
		invite_view();
	} else {
		return;
	}
		
	//code to keep Next Step buttons disabled until video is published
	//code also sends extra information--camera name and user id--with each video to be stored in DB
	CameraTag.observe('problemTwo', "published", function(){			
		myCamera = CameraTag.cameras['problemTwo'];

		var js_object = {
		    camera: "problemTwo", 
		    user: gon.current_user,
		    exploration_id: gon.exploration_id,
		    step: gon.step
		};
			
		myCamera.addVideoData(js_object);
		
		$("#step1Button").removeAttr('disabled');
	});
		
	CameraTag.observe('problemFour', "published", function(){			
		myCamera = CameraTag.cameras['problemFour'];

		var js_object = {
		    camera: "problemFour", 
		    user: gon.current_user,
		    exploration_id: gon.exploration_id,
		    step: gon.step
		};
			
		myCamera.addVideoData(js_object);
		
		$("#step3Button").removeAttr('disabled');
	});
		
	CameraTag.observe('problemFive', "published", function(){			
		myCamera = CameraTag.cameras['problemFive'];

		var js_object = {
		    camera: "problemFive", 
		    user: gon.current_user,
		    exploration_id: gon.exploration_id,
		    step: gon.step
		};
		
		myCamera.addVideoData(js_object);
			
		$("#step5Button").removeAttr('disabled');
	});
		
	CameraTag.observe('problemSix', "published", function(){			
		myCamera = CameraTag.cameras['problemSix'];

		var js_object = {
		    camera: "problemSix", 
		    user: gon.current_user,
		    exploration_id: gon.exploration_id,
		    step: gon.step
		};
			
		myCamera.addVideoData(js_object);
		
		$("#step6Button").removeAttr('disabled');
	});
	
	// this last block doesn't keep the button inactive since the video submission is optional	
	CameraTag.observe('problemSeven', "published", function(){			
		myCamera = CameraTag.cameras['problemSeven'];

		var js_object = {
		    camera: "problemSeven", 
		    user: gon.current_user,
		    exploration_id: gon.exploration_id,
		    step: gon.step
		};
			
		myCamera.addVideoData(js_object);

	});
		
});