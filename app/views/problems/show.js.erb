$(document).ready(function(){
	
	// code to show correct view if user is in first step of providing input
	function move_to_first_view() {
		if ($("#firstSideArea").hasClass("show")){
			$("#firstSideArea").removeClass("show").addClass("hidden");
		}
		$("#pstep1").removeClass("hidden").addClass("show");
		if ($("#pstep2").hasClass("show")){
			$("#pstep2").removeClass("show").addClass("hidden");
		}
		if ($("#pstep3").hasClass("show")){
			$("#pstep3").removeClass("show").addClass("hidden");
		}
		if ($("#pfinished").hasClass("show")){
			$("#pfinished").removeClass("show").addClass("hidden");
		}
		if ($(".initialBackgroundHeader").hasClass("show")){
			$(".initialBackgroundHeader").removeClass("show").addClass("hidden");
		}
		if ($(".responseBackgroundHeader").hasClass("hidden")){
			$(".responseBackgroundHeader").removeClass("hidden").addClass("show");
		}
		$.ajax({  
			type: "GET",    
	    	url: "/problems"
	  	});
	}
	
	// code to show correct view if user is in second step of providing input
	function move_to_second_view() {
		if ($("#firstSideArea").hasClass("show")){
			$("#firstSideArea").removeClass("show").addClass("hidden");
		}
		$("#pstep2").removeClass("hidden").addClass("show");
		if ($("#pstep1").hasClass("show")){
			$("#pstep1").removeClass("show").addClass("hidden");
		}
		if ($("#pstep3").hasClass("show")){
			$("#pstep3").removeClass("show").addClass("hidden");
		}
		if ($("#pfinished").hasClass("show")){
			$("#pfinished").removeClass("show").addClass("hidden");
		}
		if ($(".initialBackgroundHeader").hasClass("show")){
			$(".initialBackgroundHeader").removeClass("show").addClass("hidden");
		}
		if ($(".responseBackgroundHeader").hasClass("hidden")){
			$(".responseBackgroundHeader").removeClass("hidden").addClass("show");
		}
		$.ajax({  
			type: "GET",    
	    	url: "/problems"
	  	});
	}
	
	// code to show correct view if user is in third step of providing input
	function move_to_third_view() {
		if ($("#firstSideArea").hasClass("show")){
			$("#firstSideArea").removeClass("show").addClass("hidden");
		}
		$("#pstep3").removeClass("hidden").addClass("show");
		if ($("#pstep1").hasClass("show")){
			$("#pstep1").removeClass("show").addClass("hidden");
		}
		if ($("#pstep2").hasClass("show")){
			$("#pstep2").removeClass("show").addClass("hidden");
		}
		if ($("#pfinished").hasClass("show")){
			$("#pfinished").removeClass("show").addClass("hidden");
		}
		if ($(".initialBackgroundHeader").hasClass("show")){
			$(".initialBackgroundHeader").removeClass("show").addClass("hidden");
		}
		if ($(".responseBackgroundHeader").hasClass("hidden")){
			$(".responseBackgroundHeader").removeClass("hidden").addClass("show");
		}
		$.ajax({  
			type: "GET",    
	    	url: "/problems"
	  	});
	}
	
	// code to show correct view if user is in finished providing input
	function move_to_invite_view() {
		if ($("#firstSideArea").hasClass("show")){
			$("#firstSideArea").removeClass("show").addClass("hidden");
		}
		$("#pfinished").removeClass("hidden").addClass("show");
		if ($("#pstep1").hasClass("show")){
			$("#pstep1").removeClass("show").addClass("hidden");
		}
		if ($("#pstep2").hasClass("show")){
			$("#pstep2").removeClass("show").addClass("hidden");
		}
		if ($("#pstep3").hasClass("show")){
			$("#pstep3").removeClass("show").addClass("hidden");
		}
		if ($(".initialBackgroundHeader").hasClass("show")){
			$(".initialBackgroundHeader").removeClass("show").addClass("hidden");
		}
		if ($(".responseBackgroundHeader").hasClass("hidden")){
			$(".responseBackgroundHeader").removeClass("hidden").addClass("show");
		}
		$.ajax({  
			type: "GET",    
	    	url: "/problems"
	  	});
	}
	
	// code to insert correct partial called by view
	if ($("#pstep1").hasClass("show")) {
		$("#pstep1").html("<%=j render :partial => 'first1' %>");
	}
	if ($("#pstep2").hasClass("show")) {
		$("#pstep2").html("<%=j render :partial => 'second2' %>");
		
	}
	if ($("#pstep3").hasClass("show")) {
		$("#pstep3").html("<%=j render :partial => 'third3' %>");
	}
	if ($("#pfinished").hasClass("show")) {
		$("#pfinished").html("<%=j render :partial => 'finish' %>");
	}
	
	//code to check if written input has been provided
	$("#textInputArea1").on("keyup", function(){
		$(".responseButton").removeAttr('disabled');
	});
	$("#textInputArea3").on("keyup", function(){
		$(".responseButton").removeAttr('disabled');
	});
	
	$(".noWebcam").on("click", function(){
	    
	    if ($(this).hasClass("one")) {
	    	if ($("#problemTwo").hasClass("show")) {
	    		$("#problemTwo").removeClass("show").addClass("hidden");
				$("#textInputArea1").removeClass("hidden").addClass("show");
				$(".noWebcam").html("Use webcam option.");	
	    	} else {
	    		$("#problemTwo").removeClass("hidden").addClass("show");
	    		$("#textInputArea1").removeClass("show").addClass("hidden");
	    		$(".noWebcam").html("Provide written response instead.");
	    		$("#step1Button").attr('disabled', true);
	    	}

		} 
		if ($(this).hasClass("three")) {
	    	if ($("#problemFour").hasClass("show")) {
	    		$("#problemFour").removeClass("show").addClass("hidden");
				$("#textInputArea3").removeClass("hidden").addClass("show");
				$(".noWebcam").html("Use webcam option.");
	    	} else {
	    		$("#problemFour").removeClass("hidden").addClass("show");
	    		$("#textInputArea3").removeClass("show").addClass("hidden");
	    		$(".noWebcam").html("Provide written response instead.");
	    		$("#step3Button").attr('disabled', true);
	    	}

		} 
	});
	
	$(".step.one.visited").on("click", function(){
		move_to_first_view();
	});
	$(".step.two.visited").on("click", function(){
		move_to_second_view();
	});
	$(".step.three.visited").on("click", function(){
		move_to_third_view();
	});
	$(".step.finished.visited").on("click", function(){
		move_to_invite_view();
	});
	
	// attempt to re-initialize any camera on the page
	CameraTag.setup();
	
});